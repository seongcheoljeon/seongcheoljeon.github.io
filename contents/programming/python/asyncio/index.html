
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Seongcheol Jeon">
      
      
        <link rel="canonical" href="https://seongcheoljeon.github.io/contents/programming/python/asyncio/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../../book_review/general_book/">
      
      <link rel="icon" href="../../../../assets/favicon/favicon-16x16.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.8">
    
    
      
        <title>asyncio (Asynchronous I/O) 비동기 프로그래밍 - Seongcheol Jeon - blog</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../css/extra.css">
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#asyncio-asynchronous-io" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Seongcheol Jeon - blog" class="md-header__button md-logo" aria-label="Seongcheol Jeon - blog" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Seongcheol Jeon - blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              asyncio (Asynchronous I/O) 비동기 프로그래밍
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/" hreflang="ko" class="md-select__link">
                    Korean
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/seongcheoljeon/IndividualHDA" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    seongcheoljeon/IndividualHDA
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../material/" class="md-tabs__link">
      Material for MkDocs
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../algorithm/" class="md-tabs__link md-tabs__link--active">
        Programming
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../book_review/general_book/" class="md-tabs__link">
        Book Review
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../sample_page/" class="md-tabs__link">
        section1
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../extensions.md" class="md-tabs__link">
      None
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../contents_test/test/" class="md-tabs__link">
        본문
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Seongcheol Jeon - blog" class="md-nav__button md-logo" aria-label="Seongcheol Jeon - blog" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.png" alt="logo">

    </a>
    Seongcheol Jeon - blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/seongcheoljeon/IndividualHDA" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    seongcheoljeon/IndividualHDA
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../material/" class="md-nav__link">
        Material for MkDocs
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Programming
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Programming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Algorithm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          C/C++
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          C/C++
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../c_cpp/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../c_cpp/1_multiple_recursive_calls/" class="md-nav__link">
        다중 재귀 호출 (aka. Divide and Conquer)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../c_cpp/2_virtual_keyword/" class="md-nav__link">
        virtual, override, final 키워드
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          C#
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          C#
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          asyncio (Asynchronous I/O) 비동기 프로그래밍
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        asyncio (Asynchronous I/O) 비동기 프로그래밍
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    네이티브 코루틴 만들기
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#await" class="md-nav__link">
    await로 네이티브 코루틴 실행
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    퓨처와 태스크
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    비동기로 웹 페이지 가져오기
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-with-async-for" class="md-nav__link">
    async with와 async for 사용하기
  </a>
  
    <nav class="md-nav" aria-label="async with와 async for 사용하기">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#async-with" class="md-nav__link">
    async with
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#async-for" class="md-nav__link">
    async for
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    제네레이터 방식으로 비동기 이터레이터 만들기
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    비동기 표현식
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Book Review
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Book Review
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          General Book
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          General Book
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../book_review/general_book/" class="md-nav__link">
        일반 도서 서평
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../book_review/general_book/1_lay_and_read_algorithm/" class="md-nav__link">
        1. 누워서 읽는 알고리즘
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../book_review/general_book/2_story_of_multi_core_cpu/" class="md-nav__link">
        2. 프로그래머가 몰랐던 멀티코어 CPU 이야기
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Development Book
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Development Book
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../book_review/development_book/" class="md-nav__link">
        개발 도서 서평
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../book_review/development_book/1_five_lines_of_code/" class="md-nav__link">
        1. Five Lines of Code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          section1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          section1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
      
      
      
        <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
          section1-1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          section1-1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sample_page/" class="md-nav__link">
        section1-1-1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
      
      
      
        <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
          section1-2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          section1-2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sample_page/" class="md-nav__link">
        section1-2-1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../extensions.md" class="md-nav__link">
        None
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          본문
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          본문
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contents_test/test/" class="md-nav__link">
        테스트
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    네이티브 코루틴 만들기
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#await" class="md-nav__link">
    await로 네이티브 코루틴 실행
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    퓨처와 태스크
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    비동기로 웹 페이지 가져오기
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-with-async-for" class="md-nav__link">
    async with와 async for 사용하기
  </a>
  
    <nav class="md-nav" aria-label="async with와 async for 사용하기">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#async-with" class="md-nav__link">
    async with
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#async-for" class="md-nav__link">
    async for
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    제네레이터 방식으로 비동기 이터레이터 만들기
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    비동기 표현식
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="asyncio-asynchronous-io">asyncio (Asynchronous I/O) 비동기 프로그래밍<a class="headerlink" href="#asyncio-asynchronous-io" title="Permanent link">&para;</a></h1>
<p>asyncio는 비동기 프로그래밍을 위한 모듈이며, CPU 작업과 I/O를 병렬로 처리하게 해준다.   </p>
<p>동기(synchronous) 처리는 특정 작업이 끝나면 다음 작업을 처리하는 순차처리 방식이다. <br />
비동기(asynchronous) 처리는 여러 작업을 처리하도록 예약한 뒤 작업이 끝나면 결과를 받는 방식이다.   </p>
<h2 id="_1">네이티브 코루틴 만들기<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>먼저 asyncio를 사용하려면 다음과 같이 async def로 네이티브 코루틴을 만든다. 참고로 파이썬에서는 제네레이터 기반의 코루틴과 구분하기 위해 async def로 만든 코루틴은 네이티브 코루틴이라고 한다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">함수이름</span><span style="color: #f8f8f2">():</span>
    <span style="color: #f8f8f2">코드</span><span style="color: #f92672">...</span>
</code></pre></div></td></tr></table></div>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">asyncio</span>

<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">hello</span><span style="color: #f8f8f2">():</span>               <span style="color: #75715e"># async def로 네이티브 코루틴을 만듦</span>
    <span style="color: #f8f8f2">print(</span><span style="color: #e6db74">&#39;hello, world!&#39;</span><span style="color: #f8f8f2">)</span>

<span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>  <span style="color: #75715e"># 이벤트 루프를 얻음</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(hello())</span> <span style="color: #75715e"># hello가 끝날 때까지 기다림</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">close()</span>                     <span style="color: #75715e"># 이벤트 루프를 닫음</span>

<span style="color: #75715e"># 결과</span>
<span style="color: #f8f8f2">hello,</span> <span style="color: #f8f8f2">world</span><span style="color: #960050; background-color: #1e0010">!</span>
</code></pre></div></td></tr></table></div>
<p>먼저 async def로 hello를 만든다. 그 다음 asyncio.get_event_loop 함수로 이벤트 루프를 얻고 loop.run_until_complete(hello())와 같이 run_until_complete에 코루틴 객체를 넣는다.   </p>
<ul>
<li>이벤트루프 = asyncio.get_event_loop()</li>
<li>이벤트루프.run_until_complete(코루틴객체 또는 퓨처객체)</li>
</ul>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>  <span style="color: #75715e"># 이벤트 루프를 얻음</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(hello())</span> <span style="color: #75715e"># hello가 끝날 때까지 기다림</span>
</code></pre></div></td></tr></table></div>
<p>run_until_complete는 네이티브 코루틴이 이벤트 루프에서 실행되도록 예약하고 해당 네이티브 코루틴이 끝날 때까지 기다린다. 이렇게 하면 이벤트 루프를 통해서 hello 코루틴이 실행된다. 할 일이 끝났으면 loop.close로 이벤트 루프를 닫아준다.   </p>
<h2 id="await">await로 네이티브 코루틴 실행<a class="headerlink" href="#await" title="Permanent link">&para;</a></h2>
<p>다음과 같이 await 뒤에 코루틴 객체, 퓨처 객체, 태스크 객체를 지정하면 해당 객체가 끝날 때까지 기다린 뒤 결과를 반환한다. await는 단어 듯 그대로 특정 객체가 끝날 때까지 기다린다.   </p>
<ul>
<li>변수 = await 코루틴객체</li>
<li>변수 = await 퓨처객체</li>
<li>변수 = await 태스크객체</li>
</ul>
<p>여기서 주의할 점이 있는데 await는 네이티브 코루틴 안에서만 사용할 수 있다는 것이다.   </p>
<p>다음은 두 수를 더하는 네이티브 코루틴을 만들고 코루틴에서 1초 대기한 뒤 결과를 반환하는 예제이다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">asyncio</span>


<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">add</span><span style="color: #f8f8f2">(a,</span> <span style="color: #f8f8f2">b):</span>
    <span style="color: #f8f8f2">print(</span><span style="color: #e6db74">&#39;{0} + {1}&#39;</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">format(a,</span> <span style="color: #f8f8f2">b))</span>
    <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sleep(</span><span style="color: #ae81ff">1.0</span><span style="color: #f8f8f2">)</span>    <span style="color: #75715e"># 1초 대기. asyncio.sleep도 네이티브 코루틴</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">a</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">b</span>


<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">print_add</span><span style="color: #f8f8f2">(a,</span> <span style="color: #f8f8f2">b):</span>
    <span style="color: #75715e"># await로 다른 네이티브 코루틴 실행하고 반환값 저장</span>
    <span style="color: #f8f8f2">res</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">add(a,</span> <span style="color: #f8f8f2">b)</span>
    <span style="color: #f8f8f2">print(</span><span style="color: #e6db74">&#39;{0} + {1} = {2}&#39;</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">format(a,</span> <span style="color: #f8f8f2">b,</span> <span style="color: #f8f8f2">res))</span>


<span style="color: #75715e"># 이벤트 루트 얻음</span>
<span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>
<span style="color: #75715e"># print_add가 끝날 때까지 이벤트 루프 실행</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(print_add(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">2</span><span style="color: #f8f8f2">))</span>
<span style="color: #75715e"># 이벤트 루프 닫음</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">close()</span>


<span style="color: #75715e"># 결과</span>
<span style="color: #ae81ff">1</span> <span style="color: #f92672">+</span> <span style="color: #ae81ff">2</span>
<span style="color: #ae81ff">1</span> <span style="color: #f92672">+</span> <span style="color: #ae81ff">2</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">3</span>
</code></pre></div></td></tr></table></div>
<p>print_add에서는 await로 add를 실행하고 반환값을 변수에 저장한다. 이렇게 코루틴 안에서 다른 코루틴을 실행할 때는 await를 사용한다.   </p>
<p>add에서는 await asyncio.sleep(1.0)으로 1초 대기한 뒤 return a+b로 두 수를 더한 결과를 반환한다. 사실 await asyncio.sleep(1.0)은 없어도 되지만 코루틴이 비동기로 실행된느 모습을 확인하기 위해 사용했다. 특히 asyncio.sleep도 네이티브 코루틴이라 await를 사용해야 한다.   </p>
<h2 id="_2">퓨처와 태스크<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>퓨처(asyncio.Future)는 미래에 할 일을 표현하는 클래스인데 할 일을 취소하거나 상태 확인, 완료 및 결과 설정에 사용한다.   </p>
<p>태스크(asyncio.Task)는 asyncio.Future의 파생 클래스이며 asyncio.Future의 기능과 실행할 코루틴의 객체를 포함하고 있다. 태스크는 코루틴의 실행을 취소하거나 상태 확인, 완료 및 결과 설정에 사용한다.    </p>
<h2 id="_3">비동기로 웹 페이지 가져오기<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>asynio를 사용하여 비동기로 웹 페이지를 가져와보자.   </p>
<p>그 전에 다음과 같이 asyncio를 사용하지 않고 웹 페이지를 순차적으로 가져오겠다. urllib, request의 urlopen으로 웹 페이지를 가져온 뒤 웹 페이지의 길이를 출력해보자.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #75715e"># 동기(순차적)로 웹페이지 가져오기</span>

<span style="color: #f92672">from</span> <span style="color: #f8f8f2">time</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">time</span>
<span style="color: #f92672">from</span> <span style="color: #f8f8f2">urllib.request</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">Request,</span> <span style="color: #f8f8f2">urlopen</span>

<span style="color: #f8f8f2">urls</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;https://www.google.co.kr/search?q=&#39;</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">i</span>
            <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;apple&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;pear&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;grape&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;pineapple&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;orange&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;strawberry&#39;</span><span style="color: #f8f8f2">]</span>
        <span style="color: #f8f8f2">]</span>

<span style="color: #f8f8f2">begin</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">time()</span>
<span style="color: #f8f8f2">result</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">url</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">urls:</span>
    <span style="color: #75715e"># user-agent가 없으면 403에러 발생</span>
    <span style="color: #f8f8f2">request</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Request(url,</span> <span style="color: #f8f8f2">headers</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">{</span><span style="color: #e6db74">&#39;User-Agent&#39;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;Mozilla/5.0&#39;</span><span style="color: #f8f8f2">})</span>

    <span style="color: #f8f8f2">response</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">urlopen(request)</span>
    <span style="color: #f8f8f2">page</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">response</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">read()</span>
    <span style="color: #f8f8f2">result</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(len(page))</span>


<span style="color: #f8f8f2">print(result)</span>
<span style="color: #f8f8f2">end</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">time()</span>
<span style="color: #f8f8f2">print(</span><span style="color: #e6db74">&#39;실행 시간: {0:.3f}초&#39;</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">format(end</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">begin))</span>


<span style="color: #75715e"># 결과</span>
<span style="color: #f8f8f2">[</span><span style="color: #ae81ff">74443</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">137795</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">84429</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">327409</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">65139</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">154872</span><span style="color: #f8f8f2">]</span>
<span style="color: #f8f8f2">실행</span> <span style="color: #f8f8f2">시간:</span> <span style="color: #ae81ff">4.865</span><span style="color: #f8f8f2">초</span>
</code></pre></div></td></tr></table></div>
<p>그럼 이제 asyncio를 사용해서 비동기로 실행해보자.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">asyncio</span>
<span style="color: #f92672">from</span> <span style="color: #f8f8f2">time</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">time</span>
<span style="color: #f92672">from</span> <span style="color: #f8f8f2">urllib.request</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">Request,</span> <span style="color: #f8f8f2">urlopen</span>

<span style="color: #f8f8f2">urls</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;https://www.google.co.kr/search?q=&#39;</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">i</span>
            <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;apple&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;pear&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;grape&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;pineapple&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;orange&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;strawberry&#39;</span><span style="color: #f8f8f2">]</span>
        <span style="color: #f8f8f2">]</span>

<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">fetch</span><span style="color: #f8f8f2">(url):</span>
    <span style="color: #75715e"># user-agent가 없으면 403 에러 발생</span>
    <span style="color: #f8f8f2">request</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Request(url,</span> <span style="color: #f8f8f2">headers</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">{</span><span style="color: #e6db74">&#39;User-Agent&#39;</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;Mozilla/5.0&#39;</span><span style="color: #f8f8f2">})</span>
    <span style="color: #f8f8f2">response</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_in_executor(</span><span style="color: #66d9ef">None</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">urlopen,</span> <span style="color: #f8f8f2">request)</span>
    <span style="color: #f8f8f2">page</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_in_executor(</span><span style="color: #66d9ef">None</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">response</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">read)</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">len(page)</span>

<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #75715e"># 태스크(퓨처) 객체를 리스트로 만듦</span>
    <span style="color: #f8f8f2">futures</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ensure_future(fetch(url))</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">url</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">urls]</span>
    <span style="color: #75715e"># 결과를 한꺼번에 가져옴</span>
    <span style="color: #f8f8f2">result</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">gather(</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">futures)</span>
    <span style="color: #f8f8f2">print(result)</span>


<span style="color: #f8f8f2">begin</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">time()</span>
<span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(main())</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">close()</span>
<span style="color: #f8f8f2">end</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">time()</span>
<span style="color: #f8f8f2">print(</span><span style="color: #e6db74">&#39;실행 시간: {0:.3f}초&#39;</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">format(end</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">begin))</span>


<span style="color: #75715e"># 결과</span>
<span style="color: #f8f8f2">[</span><span style="color: #ae81ff">72734</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">119950</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">84669</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">79735</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">65231</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">154872</span><span style="color: #f8f8f2">]</span>
<span style="color: #f8f8f2">실행</span> <span style="color: #f8f8f2">시간:</span> <span style="color: #ae81ff">1.484</span><span style="color: #f8f8f2">초</span>
</code></pre></div></td></tr></table></div>
<p>asyncio를 사용하니 실행 시간이 4초대에서 1초대로 줄었습니다.   </p>
<p>urlopen이나 response.read 같은 함수는 결과가 나올 때까지 코드 실행이 중단(block)되는데 이런 함수들을 블로킹 I/O(blocking I/O) 함수라고 부른다. 특히 네이티브 코루틴 안에서 블로킹 I/O 함수를 실행하려면 이벤트 루프의 run_in_excutor 함수를 사용하여 다른 스레드에서 병렬로 실행시켜야 한다.   </p>
<p>run_in_executor의 첫 번째 인수는 executor인데 함수를 실행시켜줄 스레드 풀 또는 프로세스 풀이다. 여기서는 None을 넣어서 기본 스레드 풀을 사용한다. 그리고 두 번째 인수에는 실행할 함수를 넣고 세 번째 인수부터는 실행할 함수에 들어갈 인수를 차례대로 넣어준다.   </p>
<ul>
<li>이벤트루프.run_in_executor(None, 함수, 인수1, 인수2, 인수3)</li>
</ul>
<p>run_in_executor도 네이티브 코루틴이므로 await로 실행한 뒤 결과를 가져온다.   </p>
<p>main에서는 네이티브 코루틴 여러 개를 동시에 실행하는데 , 이때는 먼저 asyncio.ensure_future 함수를 사용하여 태스크(asyncio.Task) 객체를 생성하고 리스트로 만들어준다.   </p>
<ul>
<li>태스크객체 = asyncio.ensure_future(코루틴객체 또는 퓨처객체)</li>
</ul>
<p>그 다음 태스크 리스트를 asyncio.gather 함수에 넣어준다. asyncio.gather는 모든 코루틴 객체(퓨처, 태스크 객체)가 끝날 때까지 기다린 뒤 결과(반환값)를 리스트로 반환한다.   </p>
<ul>
<li>변수 = await asyncio.gather(코루틴객체1, 코루틴객체2)</li>
</ul>
<p>asyncio.gather는 리스트가 아닌 위치 인수로 객체를 받으므로 태스크 객체를 리스트로 만들었다면 asyncio.gather(*futures)와 같이 리스트를 언패킹해서 넣어준다. 또한, asyncio.gather도 코루틴이므로 await로 실행한 뒤 결과를 가져온다.   </p>
<p>참고로 asyncio.gather에 퓨처 객체를 넣은 순서와 결과 리스트에서 요소의 순서는 일치하지 않을 수도 있다.   </p>
<hr />
<p>run_in_executor 같은 함수는 위치 인수만 넣을 수 있는데 파이썬에서는 키워드 인수를 많이 사용한다. run_in_executor에 키워드 인수를 사용하는 함수를 넣을 때는 functools.partial을 사용해야 한다. functools.partial은 이름 그대로 부분 함수를 만들어주는 기능이다.   </p>
<ul>
<li>functools.partial(함수, 위치인수, 키워드인수)</li>
</ul>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">functools</span>

<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">hello</span><span style="color: #f8f8f2">(executor):</span>
    <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_in_executor(</span><span style="color: #66d9ef">None</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">functools</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">partial(print,</span> <span style="color: #e6db74">&#39;hello&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;python&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">end</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39; &#39;</span><span style="color: #f8f8f2">)</span>
</code></pre></div></td></tr></table></div>
<p>functools.partial은 인수가 포함된 부분 함수를 반환하는데, 반환된 함수에 다시 인수를 지정해서 호출할 수 있다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">functools</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">hello</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">functools</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">partial(print</span><span style="color: #f92672">.</span> <span style="color: #e6db74">&#39;hello&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;python&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">end</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39; &#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">hello()</span>
<span style="color: #f8f8f2">hello</span> <span style="color: #f8f8f2">python</span>
<span style="color: #f92672">&gt;&gt;&gt;</span> <span style="color: #f8f8f2">hello(</span><span style="color: #e6db74">&#39;script&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">sep</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39;-&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">hello</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">python</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">script</span>
</code></pre></div></td></tr></table></div>
<h2 id="async-with-async-for">async with와 async for 사용하기<a class="headerlink" href="#async-with-async-for" title="Permanent link">&para;</a></h2>
<ul>
<li>async with : 클래스나 함수를 비동기로 처리한 뒤 결과를 반환하는 문법이다. </li>
<li>async for : 비동기로 반복하는 문법이다.</li>
</ul>
<h3 id="async-with">async with<a class="headerlink" href="#async-with" title="Permanent link">&para;</a></h3>
<p>async with는 with 다음에 클래스의 인스턴스를 지정하고 as 뒤에 결과를저장할 변수를 지정한다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #66d9ef">async</span> <span style="color: #66d9ef">with</span> <span style="color: #f8f8f2">클래스()</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">변수:</span>
    <span style="color: #f8f8f2">코드</span><span style="color: #f92672">...</span>
</code></pre></div></td></tr></table></div>
<p>async with로 동작하는 클래스를 만들려면 <strong>aenter</strong> (asynchronuous enter) 와 <strong>aexit</strong> (asynchronous exit) 메서드를 구현해야 한다. 그리고 메서드를 만들 때는 반드시 async def를 사용한다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #66d9ef">class</span> <span style="color: #a6e22e">클래스이름</span><span style="color: #f8f8f2">:</span>
    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__aenter__</span><span style="color: #f8f8f2">(self):</span>
        <span style="color: #f8f8f2">코드</span><span style="color: #f92672">...</span>

    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__aexit__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">exc_type,</span> <span style="color: #f8f8f2">exc_value,</span> <span style="color: #f8f8f2">traceback):</span>
        <span style="color: #f8f8f2">코드</span><span style="color: #f92672">...</span>
</code></pre></div></td></tr></table></div>
<p>다음은 1초 뒤에 덧셈 결과를 반환하는 클래스이다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">asyncio</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">AsyncAdd</span><span style="color: #f8f8f2">:</span>
    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">a,</span> <span style="color: #f8f8f2">b):</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">a</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">a</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">b</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">b</span>

    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__aenter__</span><span style="color: #f8f8f2">(self):</span>
        <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sleep(</span><span style="color: #ae81ff">1.0</span><span style="color: #f8f8f2">)</span>
        <span style="color: #75715e"># __aenter__에서 값을 반환하면 as에 지정한 변수에 들어감</span>
        <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">a</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">b</span>

    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__aexit__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">exc_type,</span> <span style="color: #f8f8f2">exc_val,</span> <span style="color: #f8f8f2">exc_tb):</span>
        <span style="color: #66d9ef">pass</span>


<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">with</span> <span style="color: #f8f8f2">AsyncAdd(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">2</span><span style="color: #f8f8f2">)</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">result:</span>
        <span style="color: #f8f8f2">print(result)</span>


<span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(main())</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">close()</span>


<span style="color: #75715e"># 결과</span>
<span style="color: #ae81ff">3</span>
</code></pre></div></td></tr></table></div>
<p><strong>aenter</strong> 메서드에서 1초 대기한 뒤 self.a와 self.b를 더한 값을 반환하도록 만든다. 이렇게 __aenter__에서 값을 반환하면 as에 지정한 변수에 들어간다. __aexit__메서드는 async with as를 완전히 벗어나면 호출되는데 여기서는 특별히 만들 부분이 없으므로 pass를 넣는다. 메서드 자체가 없으면 에러가 발생한다.   </p>
<h3 id="async-for">async for<a class="headerlink" href="#async-for" title="Permanent link">&para;</a></h3>
<p>async for로 동작하는 클래스를 만들려면 <strong>aiter</strong> (asynchorous iter) 와 <strong>anext</strong> (asynchronous next) 메서드를 구현해야 한다. 그리고 메서드를 만들 때는 반드시 async def를 사용한다.   </p>
<p>다음은 1초마다 숫자를 생성하는 비동기 반복자이다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">asyncio</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">AsyncCounter</span><span style="color: #f8f8f2">:</span>
    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">stop):</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">current</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">stop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">stop</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__aiter__</span><span style="color: #f8f8f2">(self):</span>
        <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">self</span>

    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__anext__</span><span style="color: #f8f8f2">(self):</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">current</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">stop:</span>
            <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sleep(</span><span style="color: #ae81ff">1.0</span><span style="color: #f8f8f2">)</span>
            <span style="color: #f8f8f2">r</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">current</span>
            <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">current</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span>
            <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">r</span>
        <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
            <span style="color: #66d9ef">raise</span> <span style="color: #a6e22e">StopIteration</span>


<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">AsyncCounter(</span><span style="color: #ae81ff">3</span><span style="color: #f8f8f2">):</span>
        <span style="color: #f8f8f2">print(i,</span> <span style="color: #f8f8f2">end</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39; &#39;</span><span style="color: #f8f8f2">)</span>


<span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(main())</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">close()</span>


<span style="color: #75715e"># 결과</span>
<span style="color: #ae81ff">0</span> <span style="color: #ae81ff">1</span> <span style="color: #ae81ff">2</span>
</code></pre></div></td></tr></table></div>
<p>메서드가 <strong>anext</strong>, __aiter__라는 점만 다를 뿐 일반적인 이터레이터와 만드는 방법은 같다. 반복을 끝낼 때는 StopAsyncIteration 예외를 발생시키면 된다. 물론 네이티브 코루틴을 사용할 때는 앞에 await를 붙인다. 비동기 이터레이터를 다 만들었다면 네이티브 코루틴 안에서 async for i in AsynCounter(3) 와 같이 async for에 사용하면 된다.   </p>
<h2 id="_4">제네레이터 방식으로 비동기 이터레이터 만들기<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>yield를 사용하여 제네레이터 방식으로 비동기 이터레이터를 만들 수도 있다. 다음과 같이 async def로 네이티브 코루틴을 만들고 yield를 사용하여 값을 바깥으로 전달하면 된다.   </p>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #f92672">import</span> <span style="color: #f8f8f2">asyncio</span>

<span style="color: #75715e"># 제네레이터 방식으로 만들기</span>
<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">async_counter</span><span style="color: #f8f8f2">(stop):</span>
    <span style="color: #f8f8f2">n</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
    <span style="color: #66d9ef">while</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">stop:</span>
        <span style="color: #66d9ef">yield</span> <span style="color: #f8f8f2">n</span>
        <span style="color: #f8f8f2">n</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span>
        <span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sleep(</span><span style="color: #ae81ff">1.0</span><span style="color: #f8f8f2">)</span>


<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">async_counter(</span><span style="color: #ae81ff">3</span><span style="color: #f8f8f2">):</span>
        <span style="color: #f8f8f2">print(i,</span> <span style="color: #f8f8f2">end</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39; &#39;</span><span style="color: #f8f8f2">)</span>


<span style="color: #f8f8f2">loop</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">asyncio</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_event_loop()</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_until_complete(main())</span>
<span style="color: #f8f8f2">loop</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">close()</span>


<span style="color: #75715e"># 결과</span>
<span style="color: #ae81ff">0</span> <span style="color: #ae81ff">1</span> <span style="color: #ae81ff">2</span>
</code></pre></div></td></tr></table></div>
<h2 id="_5">비동기 표현식<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>async와 await를 사용하면 리스트, 딕셔너리, 세트, 제네레이터 표현식을 비동기 표현식으로 만들 수 있다.   </p>
<ul>
<li>리스트: [변수 async for 변수 in 비동기이터레이터()]</li>
<li>딕셔너리: {키: 값 async for 키, 값 in 비동기이터레이터()}</li>
<li>세트: {변수 async for 변수 in 비동기이터레이터()}</li>
<li>제네레이터: (변수 async for 변수 in 비동기이터레이터())</li>
</ul>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #f8f8f2">a</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[i</span> <span style="color: #66d9ef">async</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">AsyncCounter(</span><span style="color: #ae81ff">3</span><span style="color: #f8f8f2">)]</span>
    <span style="color: #f8f8f2">print(a)</span>
</code></pre></div></td></tr></table></div>
<p>다음과 같이 표현식 안에서 await로 코루틴을 실행할 수도 있다. 여기서는 리스트 표현식을 예로 들었지만 딕셔너리, 세트, 제네레이터 표현식 안에서도 await를 사용할 수 있다.</p>
<ul>
<li>[await 코루틴함수() for 코루틴함수 in 코루틴함수리스트]</li>
</ul>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">async_one</span><span style="color: #f8f8f2">():</span>
    <span style="color: #66d9ef">return</span> <span style="color: #ae81ff">1</span>

<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #f8f8f2">coroutines</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[async_one,</span> <span style="color: #f8f8f2">async_one,</span> <span style="color: #f8f8f2">async_one]</span>
    <span style="color: #f8f8f2">a</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">co()</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">co</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">coroutines]</span>
    <span style="color: #f8f8f2">print(a)</span>    <span style="color: #75715e"># [1, 1, 1]</span>
</code></pre></div></td></tr></table></div>
<p>다음과 같이 표현식 안에서 await로 코루틴을 실행할 수도 있다. 여기서는 리스트 표현식을 예로 들었지만 딕셔너리, 세트, 제네레이터 표현식 안에서도 await를 사용할 수 있다.   </p>
<ul>
<li>[await 코루틴함수() for 코루틴함수 in 코루틴함수리스트]</li>
</ul>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">async_one</span><span style="color: #f8f8f2">():</span>
    <span style="color: #66d9ef">return</span> <span style="color: #ae81ff">1</span>

<span style="color: #66d9ef">async</span> <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #f8f8f2">coroutines</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[async_one,</span> <span style="color: #f8f8f2">async_one,</span> <span style="color: #f8f8f2">async_one]</span>
    <span style="color: #f8f8f2">a</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #66d9ef">await</span> <span style="color: #f8f8f2">co()</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">co</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">coroutines]</span>
    <span style="color: #f8f8f2">print(a)</span>    <span style="color: #75715e"># [1, 1, 1]</span>
</code></pre></div></td></tr></table></div>
<p>asyncio는 내용이 방대하여 이것만으론 부족하다. 여기서는 asyncio의 기본 사용 방법만 소개했다. 좀 더 깊이 학습하려면 파이썬 공식 문서를 참고해야 한다.   </p>
<p><a href="https://docs.python.org/3/library/asyncio.html">asyncio - Asynchronous I/O</a></p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 <a href="https://github.com/seongcheoljeon" target="_blank" rel="noopener">Seongcheol Jeon</a>
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/seongcheoljeon" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/saelly55" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/seongcheol-jeon-368a17205" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "header.autohide", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>