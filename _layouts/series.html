---
layout: default
---

{% include lang.html %}

<div id="page-series" class="px-1">
  <h1 class="page-heading">Series</h1>

  {% assign all_series = site.posts | map: "series" | compact | uniq | sort %}

  {% if all_series.size == 0 %}
    <p class="text-muted">No series yet.</p>
  {% else %}
    {% for series_name in all_series %}
      {% assign series_posts = site.posts | where: "series", series_name | sort: "series_part" %}
      {% assign total = series_posts | size %}

      <div class="series-block mb-3">
        <details>
          <summary class="series-block-title">
            <i class="fas fa-layer-group fa-fw me-1"></i>
            <span class="series-block-name">{{ series_name }}</span>
            <span class="series-block-count">{{ total }} posts</span>
          </summary>

          <ul class="series-block-list">
            {% for post in series_posts %}
              <li class="series-block-item {% if post.url == page.url %}active{% endif %}">
                <span class="series-block-num">{{ post.series_part }}</span>
                <a href="{{ post.url | relative_url }}" class="series-block-link">
                  {{ post.title }}
                </a>
                <span class="series-block-date">
                  {{ post.date | date: "%Y-%m-%d" }}
                </span>
              </li>
            {% endfor %}
          </ul>
        </details>
      </div>
    {% endfor %}
  {% endif %}
</div>

<style>
  #page-series .page-heading {
    margin-bottom: 2rem;
  }

  /* details/summary 기본 마커 제거 */
  .series-block details > summary {
    list-style: none;
  }
  .series-block details > summary::-webkit-details-marker {
    display: none;
  }

  .series-block-title {
    font-size: 1.1rem;
    font-weight: 600;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.5rem;
    margin-bottom: 0;
    display: flex;
    align-items: center;
    gap: 0.4rem;
    cursor: pointer;
    user-select: none;
    padding: 0.5rem 0.25rem;
    border-radius: 4px;
    transition: background 0.15s;

    &:hover {
      background: var(--post-tag-bg);
    }

    /* 커스텀 토글 화살표 */
    &::before {
      content: '▶';
      font-size: 0.65rem;
      color: var(--text-muted-color);
      transition: transform 0.2s;
      flex-shrink: 0;
    }
  }

  /* 열렸을 때 화살표 회전 */
  .series-block details[open] > .series-block-title::before {
    transform: rotate(90deg);
  }

  /* 열렸을 때 하단 테두리 복원 */
  .series-block details[open] > .series-block-title {
    border-bottom: 1px solid var(--border-color);
    border-radius: 4px 4px 0 0;
    margin-bottom: 0;
  }

  .series-block-name {
    flex: 1;
  }

  .series-block-count {
    font-size: 0.78rem;
    font-weight: 400;
    color: var(--text-muted-color);
    margin-left: auto;
    font-family: 'JetBrains Mono', monospace;
  }

  .series-block-list {
    list-style: none;
    padding: 0;
    margin: 0;
    border: 1px solid var(--border-color);
    border-top: none;
    border-radius: 0 0 4px 4px;
  }

  .series-block-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.4rem 0.5rem;
    transition: background 0.15s;

    &:hover {
      background: var(--post-tag-bg);
    }

    &:last-child {
      border-radius: 0 0 4px 4px;
    }
  }

  .series-block-num {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.5rem;
    height: 1.5rem;
    border-radius: 50%;
    background: var(--border-color);
    color: var(--text-muted-color);
    font-size: 0.75rem;
    font-weight: 600;
    flex-shrink: 0;
    font-family: 'JetBrains Mono', monospace;
  }

  .series-block-link {
    flex: 1;
    color: var(--link-color);
    text-decoration: none;
    font-size: 0.9rem;

    &:hover {
      text-decoration: underline;
    }
  }

  .series-block-date {
    font-size: 0.78rem;
    color: var(--text-muted-color);
    font-family: 'JetBrains Mono', monospace;
    flex-shrink: 0;
  }
</style>
