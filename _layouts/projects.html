---
layout: default
---

{% include lang.html %}

<div id="page-projects" class="px-1">
  <h1 class="page-heading">Projects</h1>
  <p class="projects-subtitle mb-4">Game Development & Graphics Programming Projects.</p>

  <!-- ── 컨트롤 바 ── -->
  <div class="projects-controls mb-4">
    <!-- 카테고리 필터 -->
    <div class="project-filter">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="game">Game Development</button>
      <button class="filter-btn" data-filter="graphics">Graphics</button>
      <button class="filter-btn" data-filter="houdini">Houdini</button>
      <button class="filter-btn" data-filter="cpp">C++</button>
    </div>
    <!-- 정렬 -->
    <div class="project-sort">
      <button class="sort-btn active" data-sort="newest">
        <i class="fas fa-sort-amount-down fa-fw"></i> Newest
      </button>
      <button class="sort-btn" data-sort="oldest">
        <i class="fas fa-sort-amount-up fa-fw"></i> Oldest
      </button>
      <button class="sort-btn" data-sort="name">
        <i class="fas fa-sort-alpha-down fa-fw"></i> Name
      </button>
    </div>
  </div>

  <div class="projects-list">
    {{ content }}
  </div>
</div>

<!-- ── 갤러리 모달 ── -->
<div id="gallery-modal" class="gallery-modal" aria-hidden="true">
  <button class="gallery-close" aria-label="Close">
    <i class="fas fa-times"></i>
  </button>
  <button class="gallery-prev" aria-label="Previous">
    <i class="fas fa-chevron-left"></i>
  </button>
  <button class="gallery-next" aria-label="Next">
    <i class="fas fa-chevron-right"></i>
  </button>
  <div class="gallery-content">
    <img id="gallery-img" src="" alt="">
    <div id="gallery-counter" class="gallery-counter"></div>
  </div>
</div>
<div id="gallery-overlay" class="gallery-overlay"></div>

<style>
  #page-projects .page-heading {
    margin-bottom: 0.25rem;
  }

  .projects-subtitle {
    color: var(--text-muted-color);
    font-size: 0.95rem;
  }

  /* ── 컨트롤 바 ── */
  .projects-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    align-items: center;
    justify-content: space-between;
  }

  /* ── 필터 버튼 ── */
  .project-filter {
    display: flex;
    gap: 0.4rem;
    flex-wrap: wrap;
  }

  .filter-btn {
    padding: 4px 14px;
    border-radius: 20px;
    border: 1px solid var(--border-color);
    background: transparent;
    color: var(--text-muted-color);
    font-size: 0.82rem;
    cursor: pointer;
    transition: all 0.2s;

    &:hover {
      border-color: rgba(138, 180, 248, 0.5);
      color: rgba(138, 180, 248, 0.9);
    }

    &.active {
      background: rgba(138, 180, 248, 0.12);
      border-color: rgba(138, 180, 248, 0.6);
      color: rgba(138, 180, 248, 1.0);
    }
  }

  /* ── 정렬 버튼 ── */
  .project-sort {
    display: flex;
    gap: 0.4rem;
  }

  .sort-btn {
    padding: 4px 12px;
    border-radius: 6px;
    border: 1px solid var(--border-color);
    background: transparent;
    color: var(--text-muted-color);
    font-size: 0.78rem;
    cursor: pointer;
    transition: all 0.2s;

    &:hover {
      border-color: rgba(138, 180, 248, 0.5);
      color: rgba(138, 180, 248, 0.9);
    }

    &.active {
      background: rgba(138, 180, 248, 0.12);
      border-color: rgba(138, 180, 248, 0.6);
      color: rgba(138, 180, 248, 1.0);
    }
  }

  [data-mode='light'] .filter-btn,
  [data-mode='light'] .sort-btn {
    &:hover, &.active {
      border-color: rgba(30, 100, 220, 0.6);
      color: rgba(30, 100, 220, 0.9);
    }
    &.active {
      background: rgba(30, 100, 220, 0.08);
    }
  }

  /* ── 1열 리스트 ── */
  .projects-list {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  /* ── 카드 ── */
  .project-card {
    border: 1px solid var(--border-color);
    border-radius: 12px;
    overflow: hidden;
    background: var(--card-bg);
    transition: transform 0.2s ease, box-shadow 0.2s ease;

    &:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.3);
    }

    &.hidden {
      display: none;
    }
  }

  /* ── 썸네일 ── */
  .project-thumbnail {
    position: relative;
    width: 100%;
    aspect-ratio: 21 / 9;
    background: var(--border-color);
    overflow: hidden;
    cursor: pointer;

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transition: transform 0.4s ease;
    }

    &:hover img {
      transform: scale(1.02);
    }
  }

  /* 갤러리 있을 때 아이콘 힌트 */
  .project-thumbnail.has-gallery::after {
    content: '\f03e  \f00e';
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
    position: absolute;
    bottom: 0.7rem;
    right: 0.7rem;
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.7);
    background: rgba(0, 0, 0, 0.45);
    padding: 3px 8px;
    border-radius: 4px;
    backdrop-filter: blur(4px);
    letter-spacing: 0.3em;
  }

  /* ── 상태 뱃지 ── */
  .project-status {
    position: absolute;
    top: 0.8rem;
    right: 0.8rem;
    padding: 3px 10px;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
    font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.04em;
    backdrop-filter: blur(4px);

    &.wip {
      background: rgba(255, 180, 0, 0.15);
      border: 1px solid rgba(255, 180, 0, 0.5);
      color: #ffb400;
    }

    &.done {
      background: rgba(80, 200, 120, 0.15);
      border: 1px solid rgba(80, 200, 120, 0.5);
      color: #50c878;
    }
  }

  /* ── 카테고리 뱃지 ── */
  .project-category-badge {
    position: absolute;
    top: 0.8rem;
    left: 0.8rem;
    padding: 3px 10px;
    border-radius: 4px;
    font-size: 0.72rem;
    font-weight: 600;
    font-family: 'JetBrains Mono', monospace;
    backdrop-filter: blur(4px);
    background: rgba(0, 0, 0, 0.45);
    border: 1px solid rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.85);
  }

  /* ── 카드 본문 ── */
  .project-body {
    padding: 1.25rem 1.5rem 1.5rem;
  }

  .project-title {
    font-size: 1.25rem;
    font-weight: 700;
    margin-bottom: 0.4rem;
  }

  /* ── 기간 ── */
  .project-period {
    font-size: 0.78rem;
    color: var(--text-muted-color);
    font-family: 'JetBrains Mono', monospace;
    margin-bottom: 0.75rem;

    i {
      margin-right: 0.3rem;
      opacity: 0.6;
    }
  }

  .project-desc {
    font-size: 0.9rem;
    color: var(--text-muted-color);
    line-height: 1.7;
    margin: 0 0 0.8rem;
  }

  /* ── 기술 스택 뱃지 ── */
  .project-stack {
    display: flex;
    flex-wrap: wrap;
    gap: 0.3rem;
    margin-bottom: 0.8rem;
  }

  .stack-badge {
    font-size: 0.72rem;
    font-family: 'JetBrains Mono', monospace;
    padding: 2px 8px;
    border-radius: 4px;
    border: 1px solid rgba(138, 180, 248, 0.3);
    color: rgba(138, 180, 248, 0.85);
    background: rgba(138, 180, 248, 0.07);
  }

  [data-mode='light'] .stack-badge {
    border-color: rgba(30, 100, 220, 0.3);
    color: rgba(30, 100, 220, 0.85);
    background: rgba(30, 100, 220, 0.06);
  }

  /* ── 링크 ── */
  .project-links {
    display: flex;
    gap: 0.75rem;
    margin-top: 0.8rem;
  }

  .project-link {
    font-size: 0.82rem;
    color: var(--link-color);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    transition: opacity 0.15s;

    &:hover {
      opacity: 0.75;
    }
  }

  /* ── 갤러리 모달 ── */
  .gallery-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    z-index: 9000;
    backdrop-filter: blur(4px);
  }

  .gallery-modal {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 9001;
    align-items: center;
    justify-content: center;

    &.active {
      display: flex;
    }
  }

  .gallery-overlay.active {
    display: block;
  }

  .gallery-content {
    position: relative;
    max-width: 90vw;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    align-items: center;

    img {
      max-width: 100%;
      max-height: 80vh;
      object-fit: contain;
      border-radius: 8px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
    }
  }

  .gallery-counter {
    margin-top: 0.75rem;
    font-size: 0.82rem;
    color: rgba(255, 255, 255, 0.6);
    font-family: 'JetBrains Mono', monospace;
  }

  .gallery-close,
  .gallery-prev,
  .gallery-next {
    position: fixed;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.85);
    border-radius: 50%;
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.2s;
    backdrop-filter: blur(4px);

    &:hover {
      background: rgba(255, 255, 255, 0.2);
    }
  }

  .gallery-close {
    top: 1.2rem;
    right: 1.2rem;
  }

  .gallery-prev {
    left: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
  }

  .gallery-next {
    right: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
  }

  .gallery-prev.hidden,
  .gallery-next.hidden {
    visibility: hidden;
  }
</style>

<script>
  (function () {
    /* ── 필터 & 정렬 ── */
    function initControls() {
      var filterBtns = document.querySelectorAll('.filter-btn');
      var sortBtns   = document.querySelectorAll('.sort-btn');
      var list       = document.querySelector('.projects-list');
      var activeFilter = 'all';
      var activeSort   = 'newest';

      function applyFilter() {
        var cards = list.querySelectorAll('.project-card');
        cards.forEach(function (card) {
          var cat = card.getAttribute('data-category');
          if (activeFilter === 'all' || cat === activeFilter) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });
      }

      function applySort() {
        var cards = Array.from(list.querySelectorAll('.project-card'));
        cards.sort(function (a, b) {
          if (activeSort === 'name') {
            var ta = a.querySelector('.project-title');
            var tb = b.querySelector('.project-title');
            return (ta ? ta.textContent : '').localeCompare(tb ? tb.textContent : '');
          }
          var da = a.getAttribute('data-date') || '';
          var db = b.getAttribute('data-date') || '';
          return activeSort === 'newest'
            ? db.localeCompare(da)
            : da.localeCompare(db);
        });
        cards.forEach(function (card) { list.appendChild(card); });
      }

      filterBtns.forEach(function (btn) {
        btn.addEventListener('click', function () {
          filterBtns.forEach(function (b) { b.classList.remove('active'); });
          btn.classList.add('active');
          activeFilter = btn.getAttribute('data-filter');
          applyFilter();
        });
      });

      sortBtns.forEach(function (btn) {
        btn.addEventListener('click', function () {
          sortBtns.forEach(function (b) { b.classList.remove('active'); });
          btn.classList.add('active');
          activeSort = btn.getAttribute('data-sort');
          applySort();
          applyFilter();
        });
      });
    }

    /* ── 갤러리 모달 ── */
    function initGallery() {
      var modal   = document.getElementById('gallery-modal');
      var overlay = document.getElementById('gallery-overlay');
      var img     = document.getElementById('gallery-img');
      var counter = document.getElementById('gallery-counter');
      var btnPrev = document.querySelector('.gallery-prev');
      var btnNext = document.querySelector('.gallery-next');
      var btnClose = document.querySelector('.gallery-close');

      var images  = [];
      var current = 0;

      function show(idx) {
        current = idx;
        img.src = images[current];
        counter.textContent = (current + 1) + ' / ' + images.length;
        btnPrev.classList.toggle('hidden', current === 0);
        btnNext.classList.toggle('hidden', current === images.length - 1);
      }

      function open(imgs, idx) {
        images = imgs;
        modal.classList.add('active');
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
        show(idx);
      }

      function close() {
        modal.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
        img.src = '';
        images  = [];
      }

      /* 썸네일 클릭 */
      document.querySelectorAll('.project-thumbnail').forEach(function (thumb) {
        var raw = thumb.getAttribute('data-gallery');
        if (!raw) return;

        var imgs = raw.split(',').map(function (s) { return s.trim(); }).filter(Boolean);
        if (!imgs.length) return;

        thumb.classList.add('has-gallery');
        thumb.addEventListener('click', function () { open(imgs, 0); });
      });

      btnPrev.addEventListener('click', function () { if (current > 0) show(current - 1); });
      btnNext.addEventListener('click', function () { if (current < images.length - 1) show(current + 1); });
      btnClose.addEventListener('click', close);
      overlay.addEventListener('click', close);

      /* 키보드 */
      document.addEventListener('keydown', function (e) {
        if (!modal.classList.contains('active')) return;
        if (e.key === 'ArrowLeft')  { if (current > 0) show(current - 1); }
        if (e.key === 'ArrowRight') { if (current < images.length - 1) show(current + 1); }
        if (e.key === 'Escape')     { close(); }
      });
    }

    function init() {
      initControls();
      initGallery();
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  })();
</script>
