{% comment %}
  Series navigation for posts.
  front matter:
    series: "시리즈 이름"
    series_part: 1
{% endcomment %}

{% if page.series %}
  {% assign series_posts = site.posts | where: "series", page.series | sort: "series_part" %}
  {% assign total = series_posts | size %}

  {% if total > 1 %}
    {% assign current_part = page.series_part | default: 1 | plus: 0 %}
    {% assign prev_part = current_part | minus: 1 %}
    {% assign next_part = current_part | plus: 1 %}
    {% assign prev_post = nil %}
    {% assign next_post = nil %}

    {% for sp in series_posts %}
      {% assign sp_part = sp.series_part | plus: 0 %}
      {% if sp_part == prev_part %}
        {% assign prev_post = sp %}
      {% endif %}
      {% if sp_part == next_part %}
        {% assign next_post = sp %}
      {% endif %}
    {% endfor %}

    <div class="series-nav my-4">
      <div class="series-nav-header">
        <i class="fas fa-layer-group fa-fw me-1"></i>
        <span class="series-name">{{ page.series }}</span>
        <span class="series-part">{{ current_part }} / {{ total }}</span>
      </div>

      <div class="series-nav-posts">
        {% for sp in series_posts %}
          <a href="{{ sp.url | relative_url }}"
             class="series-nav-item {% if sp.url == page.url %}active{% endif %}">
            <span class="series-nav-num">{{ sp.series_part }}</span>
            <span class="series-nav-title">{{ sp.title }}</span>
          </a>
        {% endfor %}
      </div>

      <div class="series-nav-arrows">
        {% if prev_post %}
          <a href="{{ prev_post.url | relative_url }}" class="series-arrow prev">
            <i class="fas fa-chevron-left fa-fw"></i>
            <span>{{ prev_post.title }}</span>
          </a>
        {% else %}
          <span class="series-arrow disabled"></span>
        {% endif %}

        {% if next_post %}
          <a href="{{ next_post.url | relative_url }}" class="series-arrow next">
            <span>{{ next_post.title }}</span>
            <i class="fas fa-chevron-right fa-fw"></i>
          </a>
        {% else %}
          <span class="series-arrow disabled"></span>
        {% endif %}
      </div>
    </div>
  {% endif %}
{% endif %}
